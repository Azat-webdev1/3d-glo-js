(()=>{"use strict";class e{constructor({selector:e,pattern:t={},method:n}){this.form=document.querySelector(e),this.pattern=t,this.method=n,this.elementsForm=[...this.form.elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type)),this.error=new Set}init(){this.applyStyle(),this.setPattern(),this.elementsForm.forEach((e=>e.addEventListener("input",this.chekIt.bind(this))))}isValid(e){const t={notEmpty:e=>""!==e.value.trim(),pattern:(e,t)=>t.test(e.value)};if(this.method){const n=this.method[e.id];if(n)return n.every((n=>t[n[0]](e,this.pattern[n[1]])));console.log("передайте id полей")}return!0}chekIt(e){const t=e.target;this.isValid(t)?(this.showSuccess(t),this.error.delete(t)):(this.showError(t),this.error.add(t))}showError(e){if(e.classList.remove("success"),e.classList.add("error"),e.nextElementSibling&&e.nextElementSibling.classList.contains("validator-error"))return;const t=document.createElement("div");t.textContent="Ошибка в этом поле!",t.classList.add("validator-error"),e.insertAdjacentElement("afterend",t)}showSuccess(e){e.classList.remove("error"),e.classList.add("success"),e.nextElementSibling&&e.nextElementSibling.classList.contains("validator-error")&&e.nextElementSibling.remove()}applyStyle(){const e=document.createElement("style");e.textContent="\n      body form input.success {\n        border: 2px solid green !important;\n      }\n      body form input.error {\n        border: 2px solid red !important;\n      }\n      .validator-error {\n        font-size: 14px;\n        color: red;    \n        z-index: 1;\n        position: relative;\n      }\n    ",document.head.appendChild(e)}setPattern(){this.pattern.name||(this.pattern.name=/^[а-яё]{2,}$/i),this.pattern.message||(this.pattern.message=/^[а-яё\d\.\,\? ! "" ; :]+$/gi),this.pattern.phone||(this.pattern.phone=/^\+[7](\d){11}$/),this.pattern.email||(this.pattern.email=/^\w+@\w+\.\w{2,}$/)}}const t=new e({selector:"#form1",pattern:{},method:{"form1-name":[["notEmpty"],["pattern","name"]],"form1-phone":[["notEmpty"],["pattern","phone"]],"form1-email":[["notEmpty"],["pattern","email"]]}}),n=new e({selector:"#form2",pattern:{},method:{"form2-name":[["notEmpty"],["pattern","name"]],"form2-message":[["notEmpty"],["pattern","message"]],"form2-phone":[["notEmpty"],["pattern","phone"]],"form2-email":[["notEmpty"],["pattern","email"]]}}),o=new e({selector:"#form3",pattern:{},method:{"form3-name":[["notEmpty"],["pattern","name"]],"form3-phone":[["notEmpty"],["pattern","phone"]],"form3-email":[["notEmpty"],["pattern","email"]]}}),r=function(e,t="+7 (___) ___-__-__"){const n=document.querySelectorAll(e);function o(e){const n=e.keyCode,o=t,r=o.replace(/\D/g,""),s=this.value.replace(/\D/g,"");let a=0,c=o.replace(/[_\d]/g,(function(e){return a<s.length?s.charAt(a++)||r.charAt(a):e}));a=c.indexOf("_"),-1!=a&&(c=c.slice(0,a));let l=o.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");l=new RegExp("^"+l+"$"),(!l.test(this.value)||this.value.length<5||n>47&&n<58)&&(this.value=c),"blur"==e.type&&this.value.length<5&&(this.value="")}for(const e of n)e.addEventListener("input",o),e.addEventListener("focus",o),e.addEventListener("blur",o)},s=e=>{if(void 0===e.href)return;let t=e.href.split("#")[1];document.querySelector("#"+t).scrollIntoView({behavior:"smooth",block:"start"})};(()=>{const e=document.querySelector('a[href="#service-block"]');e.addEventListener("click",(t=>{t.preventDefault(),s(e)}))})();t.init(),n.init(),o.init(),r("#form1-phone","+7__________"),r("#form2-phone","+7__________"),r("#form3-phone","+7__________"),(e=>{let t=0,n=document.querySelector("#timer-hours"),o=document.querySelector("#timer-minutes"),r=document.querySelector("#timer-seconds");const s=e=>1===String(e).length?"0"+e:String(e),a=()=>{let a=(()=>{let t=(new Date(e).getTime()-(new Date).getTime())/1e3,n=0,o=0,r=0;return t>0&&(n=Math.floor(t%60),o=Math.floor(t/60%60),r=Math.floor(t/60/60)),{timeRemaining:t,hours:r,minutes:o,seconds:n}})();n.textContent=s(a.hours),o.textContent=s(a.minutes),r.textContent=s(a.seconds),a.timeRemaining<=0&&clearInterval(t)};a(),t=setInterval(a,1e3)})("13 Sep 2021"),(()=>{const e=document.querySelector("menu"),t=document.querySelector(".menu"),n=document.querySelector("main");let o=-100;const r=()=>{if(document.documentElement.clientWidth<768)return void(e.style.transform="translate(0)");let t=requestAnimationFrame(r);o+=10,e.style.transform=`translate(${o}%)`,0===o&&cancelAnimationFrame(t)},a=t=>{t.preventDefault();const n=t.target;(n.closest(".menu")||n!==e&&n.closest('[href^="#"]'))&&e.classList.toggle("active-menu"),n.classList.contains("close-btn")||(e.style.display="flex"),null!==n.closest(".menu")||null!==n.closest("menu")?("A"===n.tagName&&"close-btn"!==n.className&&s(n),e.style.transform&&"translate(-100%)"!==e.style.transform?("A"===n.tagName||n.closest(".menu"))&&(e.style.transform="translate(-100%)"):(o=-100,r()),n.removeEventListener("click",(e=>{a(e)}))):e.style.transform="translate(-100%)"};t.addEventListener("click",(e=>{a(e)})),e.addEventListener("click",(e=>{a(e)})),n.addEventListener("click",(e=>{e.target.closest(".form-btn")||a(e)}))})(),(()=>{const e=document.querySelector(".popup"),t=document.querySelectorAll(".popup-btn"),n=document.querySelector(".popup-content"),o={count:-445,speed:15,startPos:-445,endPos:0},r=()=>{o.startPos>o.endPos?o.count-=o.speed:(o.count+=o.speed,n.style.transform=`translateY(${o.count}px)`),(o.startPos>o.endPos&&o.count>o.endPos||o.count<o.endPos)&&requestAnimationFrame(r)};t.forEach((t=>{t.addEventListener("click",(()=>{e.style.display="block",screen.width>768&&(o.count=o.startPos,requestAnimationFrame(r))}))})),e.addEventListener("click",(t=>{let n=t.target;n.classList.contains("popup-close")?e.style.display="none":(n=n.closest(".popup-content"),n||(e.style.display="none"))}))})(),(()=>{const e=document.querySelector(".service-header"),t=e.querySelectorAll(".service-header-tab"),n=document.querySelectorAll(".service-tab"),o=e=>{for(let o=0;o<n.length;o++)e===o?(t[o].classList.add("active"),n[o].classList.remove("d-none")):(t[o].classList.remove("active"),n[o].classList.add("d-none"))};o(0),e.addEventListener("click",(e=>{let n=e.target;n=n.closest(".service-header-tab"),n&&t.forEach(((e,t)=>{e===n&&o(t)}))}))})(),(()=>{const e=document.querySelectorAll(".portfolio-item"),t=document.querySelector(".portfolio-dots"),n=document.querySelector(".portfolio-content");for(let n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend",`<li class="dot ${0===n?"dot-active":""}"></li>`);const o=document.querySelectorAll(".dot");let r,s=0;const a=(e,t,n)=>{e[t].classList.remove(n)},c=(e,t,n)=>{e[t].classList.add(n)},l=()=>{a(e,s,"portfolio-item-active"),a(o,s,"dot-active"),s++,s>=e.length&&(s=0),c(e,s,"portfolio-item-active"),c(o,s,"dot-active")},i=(e=3e3)=>{r=setInterval(l,e)};n.addEventListener("click",(t=>{t.preventDefault();let n=t.target;n.matches(".portfolio-btn, .dot")&&(a(e,s,"portfolio-item-active"),a(o,s,"dot-active"),n.matches("#arrow-right")?s++:n.matches("#arrow-left")?s--:n.matches(".dot")&&o.forEach(((e,t)=>{e===n&&(s=t)})),s>=e.length&&(s=0),s<0&&(s=e.length-1),c(e,s,"portfolio-item-active"),c(o,s,"dot-active"))})),n.addEventListener("mouseover",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&clearInterval(r)})),n.addEventListener("mouseout",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&i()})),i()})(),(()=>{let e;document.querySelectorAll("#command .row img").forEach((t=>{t.addEventListener("mouseenter",(t=>{let n=t.target;e=t.target.src,n.src=n.getAttribute("data-img")})),t.addEventListener("mouseout",(t=>{t.target.src=e}))}))})(),((e=100)=>{const t=document.querySelector(".calc-block"),n=document.querySelector(".calc-type"),o=document.querySelector(".calc-square"),r=document.querySelector(".calc-day"),s=document.querySelector(".calc-count"),a=document.querySelectorAll("select.calc-type"),c=document.getElementById("total");document.querySelector("#calc").addEventListener("input",(e=>{e.target.value=e.target.value.replace(/[^\d\.]/g,"")})),t.addEventListener("change",(t=>{const a=t.target;(a.matches(".calc-day")||a.matches(".calc-type")||a.matches(".calc-square")||a.matches(".calc-count"))&&(()=>{let t=0,a=1,l=10;const i=n.options[n.selectedIndex].value,m=+o.value;s.value>1&&(a+=(s.value-1)/10),r.value&&(r.value<5?l*=2:r.value<10&&(l*=1.5)),i&&m&&(t=e*i*m*a*l),c.textContent=+t.toFixed(0)})()})),a.forEach((e=>{e.addEventListener("change",(e=>{e.target.selectedIndex||(o.value="",r.value="",s.value="")}))}))})(100),(()=>{const e=()=>{const e=document.querySelector(".status-message"),t=document.querySelector(".popup");e&&setTimeout((()=>{e.remove(),t.style.display="none"}),3e3)},t=t=>{const n=document.getElementById(t),o=document.createElement("div"),r=document.querySelectorAll(".form-email"),s=document.querySelectorAll("input"),a=document.querySelectorAll(".form-btn");o.classList.add("status-message"),o.style.cssText="font-size: 2rem; color: #fff",r.forEach((e=>{e.setAttribute("required","")})),s.forEach((e=>{e.addEventListener("input",(e=>{e.target.closest(".error")?a.forEach((e=>{e.setAttribute("disabled",!0)})):a.forEach((e=>{e.removeAttribute("disabled")}))}))})),n.addEventListener("submit",(r=>{var s;r.preventDefault(),o.textContent="Загрузка...",n.appendChild(o),(s=Object.fromEntries(new FormData(n)),fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"})).then((n=>{if(200!==n.status)throw new Error("status network not 200");o.style.cssText="font-size: 2rem;\n            color: green; ",e(),o.textContent="Спасибо! Мы скоро с вами свяжемся!",(e=>{[...document.getElementById(e).elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type)).forEach((e=>e.value=""))})(t)})).catch((t=>{o.style.cssText="font-size: 2rem;\n            color: red; ",e(),o.textContent="Что-то пошло не так...",console.error(t)}))}))};t("form1"),t("form2"),t("form3")})()})();